<html>
<head>
    <title>Rocket or Tower - James Pucula</title>
    <meta charset='UTF-8'>
    <meta content='width=device-width, initial-scale=1' name='viewport'/>

    <meta name='description' content='James Pucula'>
    <meta name='keywords' content='static, writing'>
    <meta name='author' content='James Pucula'>

    <link href='/css/blog.css' rel='stylesheet'/>
    <link href='/css/trac.css' rel='stylesheet'/>
    <link href='/css/markdown.css' rel='stylesheet'/>

    <script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  jax: ['input/TeX', 'output/HTML-CSS'],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
    extensions: ['color.js']
  },
  messageStyle: 'none',
  'HTML-CSS': { preferredFont: 'TeX', availableFonts: ['STIX','TeX'] }
});
</script>

<script src='//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML' type='text/javascript'></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
</head>
<body>
<div class='content'>
    <div class='nav'>
    <ul class='wrap'>
        <li><a href='/'><img src='/assets/logo.png'></img></a></a></li>
    </ul>
</div>
    <div class='front-matter'>
        <div class='wrap'>
            <h1>Rocket or Tower</h1>
            <h4>My attempt to build a neurel network using resnet34 to classify rockets and towers</h4>
            <div class='bylines'>
                <div class='byline'>
                    <h3>Published</h3>
                    <p>01 January 2018</p>
                </div>
                <div class='byline'>
                    <h3>Updated</h3>
                    <p>01 June 2020</p>
                </div>
            </div>
            <div class='clear'></div>
        </div>
    </div>
    <div class='wrap article'>
        <p>Recently I started working on <a href="https://fast.ai">fast.ai</a>, this is my attempt at creating a network.</p>

<h2 id="attempt-one">Attempt One</h2>

<p>My training set contains 10 rockets and 10 towers</p>

<div class="figure">
    <img src="/assets/rocket-or-tower/tower.png" style="display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 1.</span> CN Tower, definately a tower.
    </div>
</div>

<p>Using the the 3 line program from the fast.ai library for the precompiled model <a href="https://github.com/KaimingHe/deep-residual-networks">resnet</a></p>

<p>0 is more rocket-like, 1 is more building-like</p>

<p>With having only 10 examples of each. It is amazing how well it did. Only misclassifing the CN tower just barely to being a rocket</p>

<div class="figure">
    <img src="/assets/rocket-or-tower/result.png" style="width: 100%; display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 2.</span> Running agaisnt the standard resnet model with only 10 examples leads an already close result
    </div>
</div>

<h2 id="attempt-two">Attempt Two</h2>

<p>In this attempt, I added 300 more photos for each and added 15 for the validation set. This time adding data augmentation, variable learning rate and unfreezing the resnet model</p>

<h3 id="data-augmentation">Data Augmentation</h3>

<p>Modify the image slightly to known effects of a camera. This is transformations that shift, zoom and flip the images. These are fed into the learning like any other image</p>
<div class="figure">
    <img src="/assets/rocket-or-tower/aug.png" style="width: 100%; display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 3.</span> Demonstration of the augmentations done to the image to help the classifier, ie you would still call these rockets
    </div>
</div>

<h3 id="stochastic-gradient-descent-with-restarts">Stochastic Gradient Descent with Restarts</h3>

<p>When a network is learning a function. It needs to start off high and reduce to gain more accuracy. This is included but also is restarted every epoch. This helps generalize the network, by trying avoiding narrow minimums. Creating a learning rate like thisâ€¦</p>

<div class="figure">
    <img src="/assets/rocket-or-tower/learning.png" style="display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 4.</span> Learning rate with restarts
    </div>
</div>

<p>This is improved a little bit more by slowing down the learning rate on the later epochs.</p>

<div class="figure">
    <img src="/assets/rocket-or-tower/learning2.png" style="display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 5.</span> Learning rate with delayed restarts
    </div>
</div>

<h3 id="training-the-precomputed-model">Training the precomputed Model</h3>

<p>Before training was done on the last few layers. This opens the begining layers. Also much lower learning rates are used in decreasing order to the earlier layers</p>

<h3 id="result">Result</h3>

<p>96.6% accuracy. With one error in classification</p>

<p>The confusion matrix output, to find what values were misclassified</p>

<div class="figure">
    <img src="/assets/rocket-or-tower/confusion.png" style="display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 6.</span> Confusion matrix shows only one rocket misclassified as a tower
    </div>
</div>

<p>Below it the images it was most uncertain of including the incorrect labeling of the rocket on the bottom left.</p>

<div class="figure">
    <img src="/assets/rocket-or-tower/result2.png" style="width:100%;display: block; margin: 0 auto;" />
    <div class="caption">
        <span class="caption-label">Figure 7.</span> Most uncertain, with a much better model it is suprisingly accurate.
    </div>
</div>

    </div>
    <div id='bibliography'>
        <div class='wrap'>
            <ol class="bibliography"></ol>
        </div>
    </div>
</div>
</body>
</html>