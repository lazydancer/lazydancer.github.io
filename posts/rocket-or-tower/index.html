---
title: Rocket or Tower
date: 2019-04-01
description: ResNet34 model that classifies rockets vs. towers
---

<h1>Rocket or Tower</h1>

<p>Recently I started working on <a href="https://fast.ai">fast.ai</a>, this is my attempt at creating a network.</p>

<h2>Attempt One</h2>

<p>My training set contains 10 rockets and 10 towers</p>

<img src="tower.png" />

<p>Using the 3 line program from the fast.ai library for the precompiled model <a href="https://github.com/KaimingHe/deep-residual-networks">resnet</a>

<p>0 is more rocket-like, 1 is more building-like</p>

<p>With having only 10 examples of each. It is amazing how well it did. Only misclassifying the CN tower just barely to being a rocket

<img src="result.png" width="722px" />

<h2>Attempt Two</h2>

<p>I added a lot more photos to about 300 each for training and 15 for the validation

<p>This time adding data augmentation, variable learning rate and unfreezing the model

<h3>Data Augmentation</h3>

<p>Modify the image slightly to known effects of a camera. This is transformations that shift, zoom and flip the images. These are fed into the learning like any other image

<img src="aug.png" />

<h3>Stochastic Gradient Descent with Restarts</h3>

<p>When a network is learning a function. It needs to start off high and reduce to gain more accuracy. This is included but also is restarted every epoch. This helps generalize the network, by trying avoiding narrow minimums. Creating a learning rate like this...</p>

<img src="learning.png" />

<p>This is improved a little bit more by slowing down the learning rate on the later epochs.

<img src="learning2.png" />

<h3>Training the precomputed Model</h3>

<p>Before training was done on the last few layers. This opens the beginning layers. Also much lower learning rates are used in decreasing order to the earlier layers

<h3>Result</h3>

<p>96.6% accuracy. With one error in classification

<p>The confusion matrix output, to find what values were misclassified</p>

<img src="confusion.png" />

<p>Below are the images it was most uncertain of including the incorrect labeling of the rocket on the bottom left

<img src="result2.png" width="722px"/>
