<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" href="favicon.ico" type="image/x-icon"/>
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>

  <title>James Pucula - Rocket or Tower</title>

  <style>@import url('https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap');</style>
  <script>
    (function() {
      try {
        var stored = localStorage.getItem('theme');
        var mediaQuery = window.matchMedia ? window.matchMedia('(prefers-color-scheme: dark)') : null;
        var prefersDark = mediaQuery ? mediaQuery.matches : false;
        var theme = stored || (prefersDark ? 'dark' : 'light');
        document.documentElement.dataset.theme = theme;
      } catch (err) {
        document.documentElement.dataset.theme = 'light';
      }
    })();
  </script>
  <link rel = "stylesheet" type="text/css" href="/style.css"/>

</head>
<body>
  <header>
        <a href="/">
  <img width="64" height="64" src="/finch_128.png"></a>
    <button id="theme-toggle" class="theme-toggle" type="button">Dark mode</button>
  </header>

  <main>
<h1>Rocket or Tower</h1>

<p>Recently I started working on <a href="https://fast.ai">fast.ai</a>; this is my attempt at creating a network.</p>

<h2>Attempt One</h2>

<p>My training set contains 10 rockets and 10 towers.</p>

<img src="tower.png" />

<p>Using the three-line program from the fast.ai library for the precompiled model <a href="https://github.com/KaimingHe/deep-residual-networks">resnet</a></p>

<p>0 is more rocket-like, 1 is more building-like.</p>

<p>With only 10 examples of each, it is amazing how well it did, only misclassifying the CN tower just barely as a rocket.</p>

<img src="result.png" width="722px" />

<h2>Attempt Two</h2>

<p>I added a lot more photos to about 300 each for training and 15 for the validation.</p>

<p>This time I added data augmentation, variable learning rates and unfreezing the model.</p>

<h3>Data Augmentation</h3>

<p>Modify the image slightly to known effects of a camera. These are transformations that shift, zoom and flip the images. These are fed into the learning like any other image.</p>

<img src="aug.png" />

<h3>Stochastic Gradient Descent with Restarts</h3>

<p>When a network is learning a function, it needs to start off high and reduce to gain more accuracy. This is included but also is restarted every epoch. This helps generalize the network by trying to avoid narrow minimums, creating a learning rate like this...</p>

<img src="learning.png" />

<p>This is improved a little bit more by slowing down the learning rate on the later epochs.

<img src="learning2.png" />

<h3>Training the precomputed Model</h3>

<p>Before, training was done on the last few layers. This opens the beginning layers. Also much lower learning rates are used in decreasing order to the earlier layers.</p>

<h3>Result</h3>

<p>96.6% accuracy, with one error in classification.</p>

<p>The confusion matrix output helped find what values were misclassified.</p>

<img src="confusion.png" />

<p>Below are the images it was most uncertain of, including the incorrect labeling of the rocket on the bottom left.</p>

<img src="result2.png" width="722px"/>
  </main>
  <script>
    (function() {
      var toggle = document.getElementById('theme-toggle');
      if (!toggle) {
        return;
      }

      var root = document.documentElement;

      function currentTheme() {
        return root.dataset.theme === 'dark' ? 'dark' : 'light';
      }

      function updateLabel(theme) {
        var next = theme === 'dark' ? 'light' : 'dark';
        toggle.textContent = next.charAt(0).toUpperCase() + next.slice(1) + ' mode';
        toggle.setAttribute('aria-label', 'Activate ' + next + ' mode');
        toggle.setAttribute('aria-pressed', theme === 'dark' ? 'true' : 'false');
      }

      updateLabel(currentTheme());

      toggle.addEventListener('click', function() {
        var next = currentTheme() === 'dark' ? 'light' : 'dark';
        root.dataset.theme = next;
        try {
          localStorage.setItem('theme', next);
        } catch (err) {
          /* localStorage might be unavailable; ignore */
        }
        updateLabel(next);
      });
    })();
  </script>
  </body>
</html>
